\section{Methodology}
\subsection{measurements analysis}
We collected SIMA’s data from all 13 stations for the period of 2015-2020, where three of them
started operating in 2017. Data includes hourly measures (CHECAR) of PM\textsubscript{10}, PM\textsubscript{2.5},
solar irradiance, humidity, wind and other pollutants. The measuring instruments that are located at SIMA’s
meteorological station are required to adapt to the mexican guidelines for obtaining and communicating the
air quality index and health risks that can be found as NOM-172-SEMARNAT-2019. De las estaciones San Nicolas
y San Bernabé se realizó un filtro de días de cielo despejado haciendo uso de las mediciones de irradiancia
solar en el rango 285nm a 2800nm. En la tabla \ref{table:measurements_SIMA} se muestra el porcentaje de mediciones anuales en cada estación de la red 
del SIMA, se relleno en rojo las estaciones que tienen un porcentaje menor a 75\%, ya que con esto se considera que
las mediciones no son representativas \cite{molina2019}.
\input{table_distribution.tex}
\subsubsection{Solar irradiance}
Se seleccionaron las estaciones de San Nicolas y San Bernabé ya que estas contaban con una mayor cantidad de datos disponibles
y los radiómetros usados para las mediciones de irradiancia solar se sabían concretamente que miden en el rango 285-2800 nm.
Realizando una visualización de los datos, se seleccionaron los días de cielo despejado usando el criterio ()
como los que se muetran en la figura \ref{fig:clear_days}.
\begin{figure}[H]
    \centering
    \includegraphics[scale=0.5]{images/Clear_days.png}
    \caption{}
    \label{fig:clear_days}
\end{figure}
\subsection{Satellite data}
\subsubsection{OMI-NASA Data}
Descargamos los datos de las columnas de Ozono (O\textsubscript{3}) en Dobson Units del satélite OMI de la NASA 
(\url{https://aura.gsfc.nasa.gov/omi.html}). Los datos fueron tomados diariamente con una resolución espacial de 0.25$^{\circ}$.
Tomamos el producto OMI/Aura Ozone DOAS Total Column L3 1 day V3 (OMDOAO3e), con un código escrito en \textit{Python} obtuvimos
los promedios mensuales para cada año para así dar un valor a los días en que no se tuvo una medición en la zona metropolitana de Monterrey.
\begin{figure}[H]
    \centering
    \includegraphics[scale=0.5]{images/Ozono_Daily.png}
    \caption{}
    \label{fig:ozono_daily}
\end{figure}
\subsubsection{MODIS-NASA Data}
We downloaded the data of Aerosol Optical Depth at 550 nm (AOD\textsubscript{550nm}) from NASA’s
satellite MODIS (\url{https://ladsweb.modaps.eosdis.nasa.gov/}). The data is taken daily and with a spatial
resolution of 1 Deg. We used the product MODIS-Aqua Aerosol Cloud Water Vapor Ozone Daily L3 Global 1Deg CMG
(MYD08\_D3) and looked at two data sets: Deep Blue Combined Mean and Land and Ocean Mean. 
\begin{figure}[H]
    \centering
    \includegraphics[scale=0.5]{images/AOD_Daily_MODIS.png}
    \caption{}
\end{figure}
\subsection{SMARTS Model}
El \textit{Simple Model of the Atmosphere Radiactive Transfer of Sunshine} (SMARTS) es un modelo espectral
escrito en el lenguaje \textit{Fortran}, el cual realiza la predicción de los rayos de luz directos, difusos y la 
irradiancia global sobre cualquier geometría en la superficie de la Tierra. En base a esto se creó un código en
\textit{Python} que  realizá la lectura de los parámetros de la tabla \ref{table:parameters} y va escribiendo el archivo de entrada 
con el formato del modelo SMARTS. 
\input{table_parameters.tex}
\subsubsection{Algortimo para encontrar el AOD correspondiente a la medición}
A partir de los dias de cielo despejado se creo una base de datos que contiene la siguiente información,
código del día del año en formato yymmdd, año, mes, día, columnas de ozono correspondiente al día obtenido de los datos del
producto OMI-NASA, esto para cada estación de monitoreo, ya que estas pueden tener días de cielo despejado diferentes.
Se escribió un código en el lenguaje \textit{Python}, el cual creará el archivo de input para el modelo SMARTS usando
un AOD inicial de 0.5. El modelo SMARTS dará como resultados una matriz de espectros solares para cada  minuto entre las 9 y 16 horas,
el código de python calculará la irradiancia solar en base a la ecuación \ref{eq:irradiance}.
\begin{equation}
        I(t) = \int\limits_{285}^{2800} E(\lambda,t) d\lambda
        \label{eq:irradiance}
\end{equation}
Al tener la irradiancia solar del día, el código encontrará el valor máximo de irradiancia solar del modelo y calculara un promedio 
tomando en cuenta los valores de 30 minutos antes y después. En seguida calculará la diferencia relativa
del promedio de irradiancia solar con la medición máxima de la estación de monitoreo de acuerdo a la ecuación \ref{eq:rd}. Dependiendo de que valor tenga la diferencia relativa
se asignará un valor al AOD, este procedimiento realiza el siguiente algortimo:
\begin{enumerate}
    \item Si la diferencia relativa tiene un valor mayor a 11\%, entonces el límite inferior es el AOD con el cual se produjo esa diferencia relativa, al inicio del proceso el límite inferior del AOD es 0.01.
    \item Si la diferencia relativa tiene un valor menor a 9\%, entonces el límite superior es el AOD con el cual se produjo esa diferencia relativa, al inicio del proceso el límite superior del AOD es 1.
    \item En cualquiera de los dos casos, el nuevo valor del AOD es un promedio del límite inferior y superior.
    \item Este proceso termina cuando se obtiene una diferencia relativa entre 9\% y 11\% o el número de intentos es 10. Si la diferencia relativa se encuentra entre 9\% y 11\% este valor es guardado en una base de datos.
\end{enumerate}
\begin{equation}
    RD = \left(\frac{Model-Measurement}{Measurement}\right)*100\%
    \label{eq:rd}
\end{equation}
\subsection{Wind}